{% load staticfiles%}
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>考试</title>
<meta http-equiv = "X-UA-Compatible" content = "IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<meta name="renderer" content="webkit">
<meta name="description" content="">
<meta name="author" content="">


<link rel="stylesheet" type="text/css" href="{% static 'exam/bootstrap-3.3.7-dist/css/bootstrap.min.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'exam/css/student/testing/uploadify.css' %}">
<link rel="stylesheet" type="text/css" href=" {% static 'exam/css/student/testing/style.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'exam/css/student/testing.css' %}">
<link rel="stylesheet" href="{% static 'exam/css/student/wangEditor.min.css' %}">
<link rel="stylesheet" href="{% static 'exam/css/student/UuplodFile.css' %}">

<script type="text/javascript" src="{% static 'exam/js/jquery.min.js' %}"></script>

</head>

<body class="main-page answer-style" id="exam_answer" oncontextmenu=self.event.returnValue=false onpaste="return false" oncopy="return false">


<div class="alert alert-danger" role="alert" style="display:none"></div>
<div id="webcam">
    <span class="glyphicon glyphicon-remove" aria-hidden="true">
        ::before
    </span>
</div>

<form id="captureForm" action="capture" method="post" target="capture_iframe" style="display:none;">
    <iframe id="capture_iframe" name="capture_iframe" style="display:none;" width="1" height="1"></iframe>
    <input type="text" name="exam_results_id" />
    <input type="text" name="question_id" />
</form>


<div id="wrap">

    <div id="header">
    	<div id="top">
        	<div id="logo" style="display: block;"><a href="javascript:void(0)" style="background-image:none;"></a></div>
            <div id="swichLang">
                <span class="ch">CH</span><span class="devid">/</span><span class="en">EN</span>
            </div>
            <div id="accout">
            	<em></em><span>csq</span>
            </div>
        </div>
    </div>

    <div id="content" class="clearfix">
        <div class="paper">
            <h3 class="submit_fixed" style="text-align:center;">
             <div class="l">
             	<span class="time"><em></em><span class="timeDown">00:52:56</span></span>
                <span class="card"><em></em><a href="javascript:void(0)" class="hasShowCardLink">答题卡</a></span>


             </div>
             <div class="r">
                 <span class="conf">
                    <a href="javascript:void(0)" class="btn btn-default examEndBtn" style="width:80px;height:30px;padding:4px 0px;color:white;">交卷</a>
                 </span>
             </div>
            </h3>
            <div class="cont">
            	<h4>试卷示例</h4>

     <div class="questions">
         <div class="qh">
                <h5>单选题<span class="qh_detail">共10题，合计100.0分</span></h5>
         </div>
                <dl class="questionsContent" questionsId="59f1cbb4f92ea176cf6ea485" hasAnswered="false">
                    <dt>
                    <div class="icon-block">
                        <label class="qIndex"><span class="index">1</span></label>
                        <a name="questions_59f1cbb4f92ea176cf6ea485"></a>

                        <span class="qm"><em class="mark" num="questions_59f1cbb4f92ea176cf6ea485" title_tip="标记试题"></em></span>

                    </div>
        <span class="qc">

            <span class="qf">（10.0分)</span>


            <span class="qq">在机场、商厦、地铁等公共场所乘自动扶梯时应靠（）站立,另一侧供有急事赶路的人快行。</span>

        </span>

                    <input type="hidden" name="questionsType" value="1" />
                    <input type="hidden" name="questionsAnswered" value="" />

                    </dt>
    <span class="answers">

        <dd class="a">
            <input type="radio" class="radioOrCheck" questionsType="1" id="529f1cbb4f92ea176cf6ea4851" name="keyChk_questions_59f1cbb4f92ea176cf6ea485" answerName="key1">
            <label for="59f1cbb4f92ea176cf6ea4851" >
                <span class="qss"><span></span></span>
                <a  class="words">A. 左侧 </a>
            </label>
        </dd>
    </span>


    <span class="answers">

            <dd class="b">
                <input type="radio" class="radioOrCheck" questionsType="1" id="539f1cbb4f92ea176cf6ea4852" name="keyChk_questions_59f1cbb4f92ea176cf6ea485" answerName="key2"/>
                <label for="59f1cbb4f92ea176cf6ea4852">
                    <span class="qss"><span></span></span>
                    <a  class="words">B. 右侧 </a>
                </label>
             </dd>
    </span>
    <span class="answers">

            <dd class="c">
                <input type="radio" class="radioOrCheck" questionsType="1" id="529f1cbb4f92ea176cf6ea4853" name="keyChk_questions_59f1cbb4f92ea176cf6ea485" answerName="key3" onpaste="return false" oncopy="return false"/>
                <label for="59f1cbb4f92ea176cf6ea4853">
                    <span class="qss"><span></span></span>
                    <a  class="words">C. 中间  </a>
                </label>
                <!-- onclick="sb(this)"-->
             </dd>
    </span>

                    <dt>
                    <div class="icon-block">
                        <label class="qIndex"><span class="index">2</span></label>
                        <a name="questions_59f1cbb4f92ea176cf6ea485"></a>

                        <span class="qm"><em class="mark" num="questions_59f1cbb4f92ea176cf6ea485" title_tip="标记试题"></em></span>

                    </div>
        <span class="qc">

            <span class="qf">（10.0分)</span>
            <span class="qq">在机场、商厦、地铁等公共场所乘自动扶梯时应靠（）站立,另一侧供有急事赶路的人快行。</span>

        </span>

                    <input type="hidden" name="questionsType" value="1" />
                    <input type="hidden" name="questionsAnswered" value="" />
                    </dt>
    <span class="answers">

        <dd class="a">
            <input type="radio" class="radioOrCheck" questionsType="1" id="59f1cbb4f92ea176cf6ea4851" name="keyChk_questions_59f1cbb4f92ea176cf6ea485" answerName="key1">
            <label for="59f1cbb4f92ea176cf6ea4851" >
                <span class="qss"><span></span></span>
                <a  class="words">A. 左侧 </a>
            </label>
        </dd>
    </span>


    <span class="answers">

            <dd class="b">
                <input type="radio" class="radioOrCheck" questionsType="1" id="59f1cbb4f92ea176cf6ea4852" name="keyChk_questions_59f1cbb4f92ea176cf6ea485" answerName="key2"/>
                <label for="59f1cbb4f92ea176cf6ea4852">
                    <span class="qss"><span></span></span>
                    <a  class="words">B. 右侧 </a>
                </label>
             </dd>
    </span>
    <span class="answers">

            <dd class="c">
                <input type="radio" class="radioOrCheck" questionsType="1" id="59f1cbb4f92ea176cf6ea4853" name="keyChk_questions_59f1cbb4f92ea176cf6ea485" answerName="key3" onpaste="return false" oncopy="return false"/>
                <label for="59f1cbb4f92ea176cf6ea4853">
                    <span class="qss"><span></span></span>
                    <a  class="words">C. 中间  </a>
                </label>
                <!-- onclick="sb(this)"-->
             </dd>
    </span>
                </dl>
    </div>
            </div>
        </div>
    </div>
</div>
    <script type="text/plain" style="width:1024px;height:500px;display:none" name="key1" id="editor" oncontextmenu=self.event.returnValue=false onselectstart="return false" onpaste="return false" oncopy="return false"></script>

    <!--答题卡-->
    <div id="numberCardDom">
        <div class="answer-card">
            <h3>
            	<div class="l">
                </div>
                <span class="tit">答题卡</span>
                <div class="r">
             		<a class="card-off" href="javascript:void(0)"></a>
                </div>
            </h3>
            <div class="cont">
                <p class="intro">
                	说明：<span><em class="s1"></em>未完成</span><span><em class="s2"></em>已完成</span><span><em class="s4"></em>标记</span>
                </p>
                <dl>
                        <dt>单选题</dt>
                        <dd class="s1">
                            <a questionsIdHref="59f1cbb4f92ea176cf6ea46f" class="iconBox icon_answer_no questions_59f1cbb4f92ea176cf6ea46f" num="questions_59f1cbb4f92ea176cf6ea46f" hasAnswered="false">1</a>
                        </dd>
                    <dd class="s2">
                        <a questionsIdHref="59f1cbb4f92ea176cf6ea46f" class="iconBox icon_answer_no questions_59f1cbb4f92ea176cf6ea46f" num="questions_59f1cbb4f92ea176cf6ea46f" hasAnswered="false">2</a>
                    </dd>
                </dl>

                <div class="btn-div">
                    <button type="button" class="btn btn-default examEndBtn">立即交卷</button><br /><br />
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Modal -->

<div class="modal fade ksx" id="blurCount" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="myModalLabel">提示信息</h4>
      </div>
      <div class="modal-body" style="padding-top:60px;padding-bottom:40px;text-align:center;">
        <p class="cont_main" style="font-size:18px;"></p>
        <div class="btn-div">
            <button type="button" class="btn btn-default closeBlurCount" style="margin:15px;">确认</button>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="maskDiv" style=" background-color:#000; padding-top:250px; top:0;width:100%; height:100%; position: fixed; z-index:10000; text-align:center;filter:alpha(opacity=50);  -moz-opacity:0.5;-khtml-opacity: 0.5;opacity: 0.5; display:none">
	<img src="../../images/ajax-loader.gif" style="display:none">
</div>
<iframe name="fileup_iframe" id="fileupIframe" class="hidden"></iframe>
    {% static 'exam/' %}
<script type="text/javascript" src=" {% static 'exam/js/testing/bootstrap.min.js' %}"></script>


<script type="text/javascript" src="{% static 'exam/js/testing/jquery.webcam.js' %}"></script>
<script type="text/javascript" src="{% static 'exam/js/testing/swfobject.js' %}"></script>
<script type="text/javascript" src="{% static 'exam/js/testing/json3.js' %}"></script>
<script type="text/javascript" src="{% static 'exam/js/testing/jquery.uploadify.min.js' %}"></script>
<script src="{% static 'exam/js/testing/stickUp.js' %}"></script>
<script type="text/javascript" src="{% static 'exam/js/testing/expanding.js' %}"></script>
<script type="text/javascript" src="{% static 'exam/js/testing/screefull.js' %}"></script>
<script type="text/javascript" src="{% static 'exam/js/testing/record.js' %}"></script>

<script type="text/javascript">
    jQuery(function($) {
        $(document).ready( function() {
          //enabling stickUp on the '.navbar-wrapper' class
          $('.submit_fixed').stickUp();
        });
    });

    (function ($) {
        $(document).ready(function() {
            if ($.isFunction($.bootstrapIE6)) $.bootstrapIE6($(document));
        });
    })(jQuery);

    //切换英文
    $(".en").click(function () {
        $.ajax({
            url:'/account/set_language',
            type:'GET',
            data:{
                language:'en'
            },
            dataType:'json',
            success:function(data){
                window.location.href = window.location.href+"?"+Math.random();
            }
        })
    });

var answer_time = "3215";
var exam_info_id = "79304"; //考试ID
var exam_results_id = "3494085"; //考试关联ID
var set_full_screen = "1";//防作弊参数
var blur_count="0";//切换次数
var domain = "31709"
var examinee_user_name = "15987123191@31709";
var jwt = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE1MDkyODY4ODUuOTMwODkzfQ.r5ASyZ_w27gZj_ADxcETatSo7p_9mnVTKx5KQ1zpVZY";
var restTime="0";
var timeLimit="False";
var version="50";
var platform="windows";

//若开启全屏防作弊，则点击页面触发全屏
if(set_full_screen==0){
    $("#exam_answer").click(function () {
        //当且仅当页面处于非全屏状态时再次触发全屏请求，否则，每次点击页面都会回到页面顶部
        if(!screenfull.isFullscreen&&screenfull.enabled){
            screenfull.request();
        }
    });
}

var capture="False";
$(document).ready(function () {

    answer_time=parseInt(answer_time);
    //  考试时间倒计时
     timeDown();
});
// 在试卷未完全加载完之前一直显示加载中，不能答题，加载完之后正常答题
window.onload=function() {
    $("#loading").hide();
}

    //倒计时
    function timeDown(){
        if(answer_time==0){
            $(".timeDown").removeClass("warning");
            $(".timeDown").text("考试结束");
            alert("考试时间到！");
            if(check_subsidiary(domain) ){
               $(".examEndJumpBtn").hide();
            }
        	saveExamFn();
        }
        if(answer_time==10){
            $(".timeDown").addClass("warning");
        }
        var day = Math.floor(answer_time/86400);
        var day_left=answer_time-86400*day;
        var hour = Math.floor(day_left/3600);
        var hour_left=day_left-3600*hour;
        var minutes= Math.floor(hour_left/60);
        var seconds= hour_left-60*minutes;
        time_show=(day==0?'':(day+'天:'))+(hour<10?'0'+hour:hour)+':'+(minutes<10?'0'+minutes:minutes)+
                   ':'+(seconds<10?'0'+seconds:seconds);
        $(".timeDown").text(time_show);
        answer_time=answer_time-1;
        setTimeout("timeDown()",1000);
    }
</script>
<script type="text/javascript" src="{% static 'exam/js/testing/basic.js?v=201703021644' %}"></script>
<script type="text/javascript" src="{% static 'exam/js/testing/bootstrap-dialog.min.js' %}"></script>
<script type="text/javascript" src="{% static 'exam/js/testing/exam_answer.js?ver=201709081226' %}"></script>
<script type="text/javascript" src="{% static 'exam/js/testing/wangEditor.js' %}"></script>
<script type="text/javascript" src="{% static 'exam/js/testing/uploadFile.js' %}"></script>
<script type="text/javascript" src="{% static 'exam/js/testing/admin_main.js' %}"></script>
<script>
    $(function () {
        $(document).on('contextmenu copy', function () {
            return false;
        });
    });
</script>
<script>
    $(function () {
        $('input[type=file]').change(function () {
            if ($(this).val() == '')
                return;
            var questionsid = $(this).parents('.questionsContent').attr('questionsid');
            $(this).addClass('form-wrapped');
            $(this).wrap('<form id="fileupForm" action="/exam/attachment_operate/?method=upload&platform=pc&upload_type=upload_file" method="post" enctype="multipart/form-data" target="fileup_iframe"></form>');
            $('#fileupForm').append('<input type="hidden" name="question_id" value="'+questionsid+'">');
            $('#fileupForm').append('<input type="hidden" name="exam_results_id" value="'+exam_results_id+'">');
            $('#fileupForm').append('<input type="hidden" name="exam_info_id" value="'+exam_info_id+'">');
            $('#fileupForm').submit();
        });
        $('#fileupIframe').load(function () {
            var msg = JSON.parse($(this).contents().find('body').text());
            if (msg.msg == 'true') {
                var li = '<li><a href="'+msg.audio_url+'">'+msg.filename+'</a> <i class="glyphicon glyphicon-remove remove-file"></i></li> ';
                $('#fileupForm').parents('.filled').find('ul.file-list').append(li);
            } else
                alert ('上传失败');
            $('#fileupForm').find('input[type=hidden]').remove();
            $('.form-wrapped').unwrap().removeClass('form-wrapped');
        });
        $(document).on('click', '.file-list .remove-file', function () {
            var fileurl = $(this).prev().attr('href');
            var filename = $(this).prev().text();
            var questionsid = $(this).parents('.questionsContent').attr('questionsid');
            var span = this;
            $.ajax({
                url: '/exam/attachment_operate/?method=remove&remove_type=upload_file',
                type: 'post',
                data: 'exam_results_id='+exam_results_id+'&question_id='+questionsid+'&audio_url='+fileurl+'&filename='+filename,
                success: function (msg) {
                    msg = JSON.parse(msg);
                    if (msg.msg == 'true')
                        $(span).parent().remove();
                    else
                        alert ('删除失败');
                },
                error: function () {
                    alert ('服务器异常，稍后再试');
                }
            })
        })
    })
</script>
</body>
</html>